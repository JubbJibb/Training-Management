<section class="customer-360-section" aria-labelledby="class-history-heading">
  <h2 class="customer-360-section__title" id="class-history-heading"><i class="bi bi-calendar-event" aria-hidden="true"></i> Class History</h2>
  <div class="customer-360-section__body">
    <%= odt_table(extra_class: "table-modern-wrap") do %>
        <thead>
          <tr>
            <th class="odt-th col-xl"><span class="th-inner">Class</span></th>
            <th class="odt-th col-sm"><span class="th-inner">Date</span></th>
            <th class="odt-th col-xs"><span class="th-inner">Seats</span></th>
            <th class="odt-th col-sm"><span class="th-inner">Status</span></th>
            <th class="odt-th col-sm num"><span class="th-inner">Amount</span></th>
            <th class="odt-th cell-actions actions" aria-label="View class"><span class="th-inner"></span></th>
          </tr>
        </thead>
        <tbody>
          <% class_history_items.each do |a| %>
            <tr>
              <td class="col-xl truncate"><%= a.training_class&.title.presence || "—" %></td>
              <td class="col-sm truncate"><%= a.training_class&.date&.strftime("%d %b %Y") || "—" %></td>
              <td class="col-xs"><%= a.seats.to_i %></td>
              <td class="col-sm"><span class="badge badge-modern <%= a.payment_status == "Paid" ? "badge-payment-paid" : "badge-payment-pending" %>"><%= a.payment_status.presence || "—" %></span></td>
              <td class="col-sm odt-table-numeric num">฿<%= number_with_delimiter(a.total_final_price.to_f.round(2), delimiter: ",") %></td>
              <td class="cell-actions actions">
                <% if a.training_class %>
                  <%= link_to admin_training_class_path(a.training_class), class: "odt-icon-btn odt-icon-btn--ghost", title: "View class", aria: { label: "View class" } do %>
                    <i class="bi bi-box-arrow-up-right" aria-hidden="true"></i>
                  <% end %>
                <% end %>
              </td>
            </tr>
          <% end %>
        </tbody>
      <% end %>
    <% if class_history_items.empty? %>
      <p class="customer-360-empty">No class history yet.</p>
    <% end %>
    <% if total_class_count && total_class_count > class_history_items.size %>
      <%= link_to "View all classes (#{total_class_count})", admin_customer_path(customer, limit: "all"), class: "customer-360-quick-link mt-2 d-inline-block" %>
    <% end %>
  </div>
</section>
