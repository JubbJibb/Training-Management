<% content_for :title, "Training Classes" %>

<div class="d-flex justify-content-between align-items-center mb-4">
  <h1><i class="bi bi-calendar-event"></i> Training Classes</h1>
  <%= link_to new_admin_training_class_path, class: "btn btn-primary" do %>
    <i class="bi bi-plus-circle"></i> New Training Class
  <% end %>
</div>

<div class="card">
  <div class="card-body">
    <% if @training_classes.any? %>
      <div class="table-responsive">
        <table class="table table-hover">
          <thead>
            <tr>
              <th>Title</th>
              <th>Date</th>
              <th>Time</th>
              <th>Duration</th>
              <th>Location</th>
              <th>Instructor</th>
              <th>Attendees</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <% if @upcoming_classes.any? %>
              <% @upcoming_classes.each do |training_class| %>
                <tr>
                  <td>
                    <strong><%= link_to training_class.title, admin_training_class_path(training_class), class: "text-decoration-none" %></strong>
                  </td>
                  <td><%= training_class.date.strftime("%b %d, %Y") %></td>
                  <td>
                    <% if training_class.start_time && training_class.end_time %>
                      <%= training_class.start_time.strftime("%I:%M %p") %> - <%= training_class.end_time.strftime("%I:%M %p") %>
                    <% elsif training_class.start_time %>
                      <%= training_class.start_time.strftime("%I:%M %p") %>
                    <% else %>
                      —
                    <% end %>
                  </td>
                  <td>
                    <% if training_class.duration %>
                      <i class="bi bi-clock"></i> <%= training_class.duration %>
                    <% else %>
                      —
                    <% end %>
                  </td>
                  <td><i class="bi bi-geo-alt"></i> <%= training_class.location %></td>
                  <td><%= training_class.instructor || "—" %></td>
                  <td>
                    <span class="badge bg-info">
                      <i class="bi bi-people"></i> <%= training_class.attendees.attendees.count %>
                      <% if training_class.max_attendees %>
                        / <%= training_class.max_attendees %>
                      <% end %>
                    </span>
                  </td>
                  <td>
                    <%= link_to admin_training_class_path(training_class), class: "btn btn-sm btn-outline-primary", title: "View" do %>
                      <i class="bi bi-eye"></i>
                    <% end %>
                    <%= link_to edit_admin_training_class_path(training_class), class: "btn btn-sm btn-outline-secondary", title: "Edit" do %>
                      <i class="bi bi-pencil"></i>
                    <% end %>
                    <%= button_to admin_training_class_path(training_class), 
                        method: :delete,
                        data: { confirm: "Are you sure you want to delete this training class?" },
                        class: "btn btn-sm btn-outline-danger", title: "Delete", form: { style: "display: inline-block;" } do %>
                      <i class="bi bi-trash"></i>
                    <% end %>
                  </td>
                </tr>
              <% end %>
            <% end %>
            <% if @past_classes.any? %>
              <tr class="table-secondary">
                <td colspan="8" class="text-center fw-bold">
                  <i class="bi bi-clock-history"></i> Past Classes
                </td>
              </tr>
              <% @past_classes.each do |training_class| %>
                <tr class="table-secondary">
                  <td>
                    <strong><%= link_to training_class.title, admin_training_class_path(training_class), class: "text-decoration-none" %></strong>
                  </td>
                  <td><%= training_class.date.strftime("%b %d, %Y") %></td>
                  <td>
                    <% if training_class.start_time && training_class.end_time %>
                      <%= training_class.start_time.strftime("%I:%M %p") %> - <%= training_class.end_time.strftime("%I:%M %p") %>
                    <% elsif training_class.start_time %>
                      <%= training_class.start_time.strftime("%I:%M %p") %>
                    <% else %>
                      —
                    <% end %>
                  </td>
                  <td>
                    <% if training_class.duration %>
                      <i class="bi bi-clock"></i> <%= training_class.duration %>
                    <% else %>
                      —
                    <% end %>
                  </td>
                  <td><i class="bi bi-geo-alt"></i> <%= training_class.location %></td>
                  <td><%= training_class.instructor || "—" %></td>
                  <td>
                    <span class="badge bg-secondary">
                      <i class="bi bi-people"></i> <%= training_class.attendees.attendees.count %>
                      <% if training_class.max_attendees %>
                        / <%= training_class.max_attendees %>
                      <% end %>
                    </span>
                  </td>
                  <td>
                    <%= link_to admin_training_class_path(training_class), class: "btn btn-sm btn-outline-primary", title: "View" do %>
                      <i class="bi bi-eye"></i>
                    <% end %>
                    <%= link_to edit_admin_training_class_path(training_class), class: "btn btn-sm btn-outline-secondary", title: "Edit" do %>
                      <i class="bi bi-pencil"></i>
                    <% end %>
                    <%= button_to admin_training_class_path(training_class), 
                        method: :delete,
                        data: { confirm: "Are you sure you want to delete this training class?" },
                        class: "btn btn-sm btn-outline-danger", title: "Delete", form: { style: "display: inline-block;" } do %>
                      <i class="bi bi-trash"></i>
                    <% end %>
                  </td>
                </tr>
              <% end %>
            <% end %>
          </tbody>
        </table>
      </div>
    <% else %>
      <div class="text-center py-5">
        <i class="bi bi-calendar-x display-1 text-muted"></i>
        <p class="text-muted mt-3">No training classes yet.</p>
        <%= link_to "Create your first training class", new_admin_training_class_path, class: "btn btn-primary" %>
      </div>
    <% end %>
  </div>
</div>
