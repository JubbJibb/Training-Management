<%# Payment Status List: Customer (name+email), Segment, Amount, Due, Paid, Days to Pay, Status, Actions. Sticky header, sticky first col, nowrap dates. %>
<% payment_list = local_assigns[:payment_status_list] || [] %>
<% training_class = local_assigns[:training_class] %>
<div class="cfo-section class-finance-payment-section">
  <h2 class="cfo-section-title">Payment Status List</h2>
  <div class="cfo-table-wrap class-finance-table-wrap">
    <% if payment_list.any? %>
      <table class="odt-table odt-table--sm class-finance-payment-table" role="table" aria-label="Payment status by customer">
        <thead>
          <tr>
            <th scope="col" class="class-finance-payment-table__customer">Customer</th>
            <th scope="col">Segment</th>
            <th scope="col" class="text-end class-finance-payment-table__amount">Amount</th>
            <th scope="col" class="class-finance-payment-table__date">Due Date</th>
            <th scope="col" class="class-finance-payment-table__date">Paid Date</th>
            <th scope="col" class="text-end">Days to Pay</th>
            <th scope="col">Status</th>
            <th scope="col" class="text-end">Actions</th>
          </tr>
        </thead>
        <tbody>
          <% payment_list.each do |row| %>
            <tr>
              <td class="class-finance-payment-table__customer">
                <span class="class-finance-payment-table__name" title="<%= row[:contact].to_s %> · <%= row[:email].to_s %>"><%= row[:contact] %></span>
                <span class="class-finance-payment-table__email" aria-hidden="true"><%= row[:email] %></span>
              </td>
              <td><%= odt_badge(row[:segment], variant: row[:segment] == "Corp" ? :primary : :neutral, size: :sm) %></td>
              <td class="text-end class-finance-payment-table__amount"><%= number_to_thb(row[:amount]) %></td>
              <td class="class-finance-payment-table__date"><%= row[:due_date].present? ? row[:due_date].strftime("%d/%m/%y") : "—" %></td>
              <td class="class-finance-payment-table__date"><%= row[:payment_date].present? ? row[:payment_date].strftime("%d/%m/%y") : "—" %></td>
              <td class="text-end"><%= row[:days_to_pay].nil? ? "—" : row[:days_to_pay] %></td>
              <td><%= odt_badge(row[:status], variant: row[:status] == "Paid" ? :success : (row[:status] == "Overdue" ? :danger : :warning), size: :sm) %></td>
              <td class="text-end">
                <%= link_to edit_admin_training_class_attendee_path(training_class, row[:attendee]), class: "odt-icon-btn odt-icon-btn--ghost", title: "Edit" do %><i class="bi bi-pencil" aria-hidden="true"></i><% end %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    <% else %>
      <p class="cfo-empty">No attendees in this view.</p>
    <% end %>
  </div>
</div>
