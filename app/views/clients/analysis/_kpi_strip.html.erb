<%# ODT Premium: alternating #f9f9fe, gold accent on Avg Revenue (4) and Corporate % (6). %>
<% cells = local_assigns[:cells] || [] %>
<% accent_indices = [3, 5] %>
<section class="odt-kpi-strip ca-exec-kpi-strip" aria-label="Key metrics">
  <div class="odt-kpi-strip__inner ca-exec-kpi-strip__inner">
    <% cells.each_with_index do |cell, i| %>
      <div class="odt-kpi-strip__cell ca-exec-kpi-strip__cell <%= 'ca-exec-kpi-strip__cell--accent' if accent_indices.include?(i) %>">
        <div class="odt-kpi-strip__head">
          <% if cell[:icon].present? %>
            <span class="odt-kpi-strip__icon" aria-hidden="true"><i class="bi bi-<%= cell[:icon] %>"></i></span>
          <% end %>
          <span class="odt-kpi-strip__label"><%= cell[:label] %></span>
        </div>
        <span class="odt-kpi-strip__value <%= "odt-kpi-strip__value--#{cell[:value_variant]}" if cell[:value_variant].present? %>">
          <%= cell[:value] %>
          <% if cell[:trend].present? %>
            <% up = cell[:trend].to_s == "up" || cell[:trend].to_s == "1" || (cell[:trend].is_a?(Numeric) && cell[:trend] > 0) %>
            <span class="odt-kpi-strip__trend odt-kpi-strip__trend--<%= up ? 'up' : 'down' %>" aria-label="<%= up ? 'Up' : 'Down' %>"><%= up ? '▲' : '▼' %></span>
          <% end %>
        </span>
        <% if cell[:sub].present? %>
          <span class="odt-kpi-strip__sub"><%= cell[:sub] %></span>
        <% end %>
      </div>
    <% end %>
  </div>
</section>
